<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-56382716-11","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="alternate" type="application/rss+xml" href="/kb/rss.xml" title="The open-source hyperconverged infrastructure solution for a cloud-native world RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/kb/atom.xml" title="The open-source hyperconverged infrastructure solution for a cloud-native world Atom Feed"><title data-rh="true">3 posts tagged with &quot;VM&quot; | The open-source hyperconverged infrastructure solution for a cloud-native world</title><meta data-rh="true" property="og:title" content="3 posts tagged with &quot;VM&quot; | The open-source hyperconverged infrastructure solution for a cloud-native world"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://harvesterhci.io/kb/tags/vm"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://harvesterhci.io/kb/tags/vm"><link data-rh="true" rel="alternate" href="https://harvesterhci.io/kb/tags/vm" hreflang="en"><link data-rh="true" rel="alternate" href="https://harvesterhci.io/kb/tags/vm" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.2a831778.css">
<link rel="preload" href="/assets/js/runtime~main.0c08fa38.js" as="script">
<link rel="preload" href="/assets/js/main.2aa1bfff.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo_horizontal.svg" alt="Harvester Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo_horizontal.svg" alt="Harvester Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div></a></div><div class="navbar__items navbar__items--right"><a href="https://docs.harvesterhci.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__docs"><span>Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://www.suse.com/c/?s=harvester" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__blog"><span>Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a aria-current="page" class="navbar__item navbar__link navbar__kb navbar__link--active" href="/kb">Knowledge Base</a><a href="https://github.com/harvester/harvester" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__github btn btn-secondary icon-github"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">More from SUSE</a><ul class="dropdown__menu"><li><a href="https://www.rancher.com" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__rancher"><span>Rancher<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://elemental.docs.rancher.com/" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__elemental"><span>Elemental<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://fleet.rancher.io/" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__fleet"><span>Fleet<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://opensource.suse.com/" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__suse"><span>More Projects...<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-tags-post-list-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_a9qW thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_uKok margin-bottom--md">All Posts</div><ul class="sidebarItemList_Kvuv"><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kb/kubevirt_certificates_rotation">KubeVirt Certificates Rotation</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kb/harvester_security_best_practices">Best Practices for Harvester Security</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kb/renew_harvester_cloud_credentials">Renew Harvester Cloud Credentials</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kb/install_iscsi_firmware_install_boot">Configuring Harvester to Boot from an iSCSI Root Disk in Special Circumstances</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kb/the_potential_risk_with_filesystem_trim">Mitigating filesystem trim Risk</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kb/calculation_of_resource_metrics_in_harvester">Calculation of Resource Metrics in Harvester</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kb/best_practices_for_optimizing_longhorn_disk_performance">Best Practices for Optimizing Longhorn Disk Performance</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kb/vm_live_migration_policy_and_configuration">VM Live Migration Policy and Configuration</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kb/use_rook_ceph_external_storage">Use Rook Ceph External Storage with Harvester</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kb/upgrading_guest_clusters_with_harvester_ip_pool_compatibility">Upgrade Guest Kubernetes Clusters to be Compatible with Harvester IP Pools</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kb/install_netapp_trident_csi">Using NetApp Storage on Harvester</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kb/configure_priority_class_longhorn">Configure PriorityClass on Longhorn System Components</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kb/package_your_own_toolbox_image">Package your own Toolbox Image</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kb/scan-and-repair-vm-root-filesystem">Scan and Repair Root Filesystem of VirtualMachine</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kb/evicting-replicas-from-a-disk-the-cli-way">Evicting Replicas From a Disk (the CLI way)</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kb/nic-naming-scheme">NIC Naming Scheme</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kb/multiple-nics-vm-connectivity">Multiple NICs VM Connectivity</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kb/vm-scheduling">VM Scheduling</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><header class="margin-bottom--xl"><h1>3 posts tagged with &quot;VM&quot;</h1><a href="/kb/tags">View All Tags</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/kb/vm_live_migration_policy_and_configuration">VM Live Migration Policy and Configuration</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2023-09-01T00:00:00.000Z" itemprop="datePublished">September 1, 2023</time> · <!-- -->11 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/w13915984028" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://github.com/w13915984028.png" alt="Jian Wang"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/w13915984028" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Jian Wang</span></a></div><small class="avatar__subtitle" itemprop="description">Staff Software Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>In Harvester, the <strong>VM Live Migration</strong> is well supported by the UI. Please refer to <a href="https://docs.harvesterhci.io/v1.1/vm/live-migration" target="_blank" rel="noopener noreferrer">Harvester VM Live Migration</a> for more details.</p><p>The VM Live Migration process is finished smoothly in most cases. However, sometimes the migration may get stuck and not end as expected.</p><p>This article dives into the VM Live Migration process in more detail. There are three main parts:</p><ul><li>General Process of VM Live Migration</li><li>VM Live Migration Strategies</li><li>VM Live Migration Configurations</li></ul><p>Related issues:</p><ul><li><a href="https://github.com/harvester/harvester/issues/4352" target="_blank" rel="noopener noreferrer">Migration should show the proper status and progress in the UI</a></li><li><a href="https://github.com/harvester/harvester/issues/4376" target="_blank" rel="noopener noreferrer">VM Migration policy and status</a></li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>A big part of the following contents are copied from <code>kubevirt</code> document <a href="https://kubevirt.io/user-guide/operations/live_migration/" target="_blank" rel="noopener noreferrer">https://kubevirt.io/user-guide/operations/live_migration/</a>, some contents/formats are adjusted to fit in this document.</p></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="general-process-of-vm-live-migration">General Process of VM Live Migration<a class="hash-link" href="#general-process-of-vm-live-migration" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="starting-a-migration-from-harvester-ui">Starting a Migration from Harvester UI<a class="hash-link" href="#starting-a-migration-from-harvester-ui" title="Direct link to heading">​</a></h3><ol><li>Go to the <strong>Virtual Machines</strong> page.</li><li>Find the virtual machine that you want to migrate and select <strong>⋮</strong> &gt; <strong>Migrate</strong>.</li><li>Choose the node to which you want to migrate the virtual machine and select <strong>Apply</strong>.</li></ol><p>After successfully selecting <strong>Apply</strong>, a CRD <code>VirtualMachineInstanceMigration</code> object is created, and the related <code>controller/operator</code> will start the process.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="migration-crd-object">Migration CRD Object<a class="hash-link" href="#migration-crd-object" title="Direct link to heading">​</a></h3><p>You can also create the CRD <code>VirtualMachineInstanceMigration</code> object manually via <code>kubectl</code> or other tools.</p><p>The example below starts a migration process for a virtual machine instance (VMI) <code>new-vm</code>.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: kubevirt.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: VirtualMachineInstanceMigration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: migration-job</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  vmiName: new-vm</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Under the hood, the open source projects <code>Kubevirt, Libvirt, QEMU, ... </code> perform most of the <code>VM Live Migration</code>. <a href="#references">References.</a></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="migration-status-reporting">Migration Status Reporting<a class="hash-link" href="#migration-status-reporting" title="Direct link to heading">​</a></h3><p>When starting a virtual machine instance (VMI), it has also been calculated whether the machine is live migratable. The result is being stored in the VMI <code>VMI.status.conditions</code>. The calculation can be based on multiple parameters of the VMI, however, at the moment, the calculation is largely based on the Access Mode of the VMI volumes. Live migration is only permitted when the volume access mode is set to ReadWriteMany. Requests to migrate a non-LiveMigratable VMI will be rejected.</p><p>The reported Migration Method is also being calculated during VMI start. <code>BlockMigration</code> indicates that some of the VMI disks require copying from the source to the destination. <code>LiveMigration</code> means that only the instance memory will be copied.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Status:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Conditions:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Status: True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Type: LiveMigratable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Migration Method: BlockMigration</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="migration-status">Migration Status<a class="hash-link" href="#migration-status" title="Direct link to heading">​</a></h3><p>The migration progress status is reported in <code>VMI.status</code>. Most importantly, it indicates whether the migration has been completed or failed.</p><p>Below is an example of a successful migration.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Migration State:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Completed:        true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End Timestamp:    2019-03-29T03:37:52Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Migration Config:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Completion Timeout Per GiB:  800</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Progress Timeout:             150</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Migration UID:                  c64d4898-51d3-11e9-b370-525500d15501</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Source Node:                    node02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Start Timestamp:                2019-03-29T04:02:47Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Target Direct Migration Node Ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      35001:                      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      41068:                      49152</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      38284:                      49153</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Target Node:                  node01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Target Node Address:          10.128.0.46</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Target Node Domain Detected:  true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Target Pod:                   virt-launcher-testvmimcbjgw6zrzcmp8wpddvztvzm7x2k6cjbdgktwv8tkq</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="vm-live-migration-strategies">VM Live Migration Strategies<a class="hash-link" href="#vm-live-migration-strategies" title="Direct link to heading">​</a></h2><p>VM Live Migration is a process during which a running Virtual Machine Instance moves to another compute node while the guest workload continues to run and remain accessible.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="understanding-different-vm-live-migration-strategies">Understanding Different VM Live Migration Strategies<a class="hash-link" href="#understanding-different-vm-live-migration-strategies" title="Direct link to heading">​</a></h3><p>VM Live Migration is a complex process. During a migration, the source VM needs to transfer its whole state (mainly RAM) to the target VM. If there are enough resources available, such as network bandwidth and CPU power, migrations should converge nicely. If this is not the scenario, however, the migration might get stuck without an ability to progress.</p><p>The main factor that affects migrations from the guest perspective is its dirty rate, which is the rate by which the VM dirties memory. Guests with high dirty rate lead to a race during migration. On the one hand, memory would be transferred continuously to the target, and on the other, the same memory would get dirty by the guest. On such scenarios, one could consider to use more advanced migration strategies. Refer to <a href="https://kubevirt.io/user-guide/operations/live_migration/#understanding-different-migration-strategies" target="_blank" rel="noopener noreferrer">Understanding different migration strategies</a> for more details.</p><p>There are 3 <code>VM Live Migration</code> strategies/policies:</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="vm-live-migration-strategy-pre-copy">VM Live Migration Strategy: Pre-copy<a class="hash-link" href="#vm-live-migration-strategy-pre-copy" title="Direct link to heading">​</a></h4><p>Pre-copy is the default strategy. It should be used for most cases.</p><p>The way it works is as following:</p><ol><li>The target VM is created, but the guest keeps running on the source VM.</li><li>The source starts sending chunks of VM state (mostly memory) to the target. This continues until all of the state has been transferred to the target.</li><li>The guest starts executing on the target VM. 4. The source VM is being removed.</li></ol><p>Pre-copy is the safest and fastest strategy for most cases. Furthermore, it can be easily cancelled, can utilize multithreading, and more. If there is no real reason to use another strategy, this is definitely the strategy to go with.</p><p>However, on some cases migrations might not converge easily, that is, by the time the chunk of source VM state would be received by the target VM, it would already be mutated by the source VM (which is the VM the guest executes on). There are many reasons for migrations to fail converging, such as a high dirty-rate or low resources like network bandwidth and CPU. On such scenarios, see the following alternative strategies below.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="vm-live-migration-strategy-post-copy">VM Live Migration Strategy: Post-copy<a class="hash-link" href="#vm-live-migration-strategy-post-copy" title="Direct link to heading">​</a></h4><p>The way post-copy migrations work is as following:</p><ol><li>The target VM is created.</li><li>The guest is being run on the target VM.</li><li>The source starts sending chunks of VM state (mostly memory) to the target.</li><li>When the guest, running on the target VM, would access memory: 1. If the memory exists on the target VM, the guest can access it. 2. Otherwise, the target VM asks for a chunk of memory from the source VM.</li><li>Once all of the memory state is updated at the target VM, the source VM is being removed.</li></ol><p>The main idea here is that the guest starts to run immediately on the target VM. This approach has advantages and disadvantages:</p><p><strong>Advantages:</strong></p><ul><li>The same memory chink is never being transferred twice. This is possible due to the fact that with post-copy it doesn&#x27;t matter that a page had been dirtied since the guest is already running on the target VM.</li><li>This means that a high dirty-rate has much less effect.</li><li>Consumes less network bandwidth.</li></ul><p><strong>Disadvantages:</strong></p><ul><li>When using post-copy, the VM state has no one source of truth. When the guest (running on the target VM) writes to memory, this memory is one part of the guest&#x27;s state, but some other parts of it may still be updated only at the source VM. This situation is generally dangerous, since, for example, if either the target or guest VMs crash the state cannot be recovered.</li><li>Slow warmup: when the guest starts executing, no memory is present at the target VM. Therefore, the guest would have to wait for a lot of memory in a short period of time.</li><li>Slower than pre-copy on most cases.</li><li>Harder to cancel a migration.</li></ul><h4 class="anchor anchorWithStickyNavbar_mojV" id="vm-live-migration-strategy-auto-converge">VM Live Migration Strategy: Auto-converge<a class="hash-link" href="#vm-live-migration-strategy-auto-converge" title="Direct link to heading">​</a></h4><p>Auto-converge is a technique to help pre-copy migrations converge faster without changing the core algorithm of how the migration works.</p><p>Since a high dirty-rate is usually the most significant factor for migrations to not converge, auto-converge simply throttles the guest&#x27;s CPU. If the migration would converge fast enough, the guest&#x27;s CPU would not be throttled or throttled negligibly. But, if the migration would not converge fast enough, the CPU would be throttled more and more as time goes.</p><p>This technique dramatically increases the probability of the migration converging eventually.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="observe-the-vm-live-migration-progress-and-result">Observe the VM Live Migration Progress and Result<a class="hash-link" href="#observe-the-vm-live-migration-progress-and-result" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_mojV" id="migration-timeouts">Migration Timeouts<a class="hash-link" href="#migration-timeouts" title="Direct link to heading">​</a></h4><p>Depending on the type, the live migration process will copy virtual machine memory pages and disk blocks to the destination. During this process non-locked pages and blocks are being copied and become free for the instance to use again. To achieve a successful migration, it is assumed that the instance will write to the free pages and blocks (pollute the pages) at a lower rate than these are being copied.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="completion-time">Completion Time<a class="hash-link" href="#completion-time" title="Direct link to heading">​</a></h4><p>In some cases the virtual machine can write to different memory pages / disk blocks at a higher rate than these can be copied, which will prevent the migration process from completing in a reasonable amount of time. In this case, live migration will be aborted if it is running for a long period of time. The timeout is calculated base on the size of the VMI, it&#x27;s memory and the ephemeral disks that are needed to be copied. The configurable parameter completionTimeoutPerGiB, which defaults to 800s is the time for GiB of data to wait for the migration to be completed before aborting it. A VMI with 8Gib of memory will time out after 6400 seconds.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="progress-timeout">Progress Timeout<a class="hash-link" href="#progress-timeout" title="Direct link to heading">​</a></h4><p>A VM Live Migration will also be aborted when it notices that copying memory doesn&#x27;t make any progress. The time to wait for live migration to make progress in transferring data is configurable by the <code>progressTimeout</code> parameter, which defaults to 150 seconds.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="vm-live-migration-configurations">VM Live Migration Configurations<a class="hash-link" href="#vm-live-migration-configurations" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="changing-cluster-wide-migration-limits">Changing Cluster Wide Migration Limits<a class="hash-link" href="#changing-cluster-wide-migration-limits" title="Direct link to heading">​</a></h3><p>KubeVirt puts some limits in place so that migrations don&#x27;t overwhelm the cluster. By default, it is to only run 5 migrations in parallel with an additional limit of a maximum of 2 outbound migrations per node. Finally, every migration is limited to a bandwidth of 64MiB/s.</p><p>You can change these values in the <code>kubevirt</code> CR:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    apiVersion: kubevirt.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    kind: Kubevirt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      name: kubevirt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      namespace: kubevirt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      configuration:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        migrations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          parallelMigrationsPerCluster: 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          parallelOutboundMigrationsPerNode: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          bandwidthPerMigration: 64Mi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          completionTimeoutPerGiB: 800</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          progressTimeout: 150</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          disableTLS: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          nodeDrainTaintKey: &quot;kubevirt.io/drain&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          allowAutoConverge: false ---------------------&gt; related to: Auto-converge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          allowPostCopy: false -------------------------&gt; related to: Post-copy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          unsafeMigrationOverride: false</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Remember that most of these configurations can be overridden and fine-tuned to a specified group of VMs. For more information, please refer to the Migration Policies section below.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="migration-policies">Migration Policies<a class="hash-link" href="#migration-policies" title="Direct link to heading">​</a></h3><p><a href="https://kubevirt.io/user-guide/operations/migration_policies/" target="_blank" rel="noopener noreferrer">Migration policies</a> provides a new way of applying migration configurations to Virtual Machines. The policies can refine Kubevirt CR&#x27;s <code>MigrationConfiguration</code> that sets the cluster-wide migration configurations. This way, the cluster-wide settings default how the migration policy can be refined (i.e., changed, removed, or added).</p><p>Remember that migration policies are in version <code>v1alpha1</code>. This means that this API is not fully stable yet and that APIs may change in the future.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="migration-configurations">Migration Configurations<a class="hash-link" href="#migration-configurations" title="Direct link to heading">​</a></h4><p>Currently, the <code>MigrationPolicy</code> spec only includes the following configurations from Kubevirt CR&#x27;s <code>MigrationConfiguration</code>. (In the future, more configurations that aren&#x27;t part of Kubevirt CR will be added):</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: migrations.kubevirt.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: MigrationPolicy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    allowAutoConverge: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bandwidthPerMigration: 217Ki</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    completionTimeoutPerGiB: 23</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    allowPostCopy: false</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>All the above fields are optional. When omitted, the configuration will be applied as defined in KubevirtCR&#x27;s <code>MigrationConfiguration</code>. This way, KubevirtCR will serve as a configurable set of defaults for both VMs that are not bound to any <code>MigrationPolicy</code> and VMs that are bound to a <code>MigrationPolicy</code> that does not define all fields of the configurations.</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="matching-policies-to-vms">Matching Policies to VMs<a class="hash-link" href="#matching-policies-to-vms" title="Direct link to heading">​</a></h5><p>Next in the spec are the selectors defining the group of VMs to apply the policy. The options to do so are the following.</p><p>This policy applies to the VMs in namespaces that have all the required labels:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: migrations.kubevirt.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: MigrationPolicy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  selectors:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    namespaceSelector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      hpc-workloads: true       # Matches a key and a value</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>The policy below applies to the VMs that have all the required labels:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: migrations.kubevirt.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: MigrationPolicy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  selectors:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    virtualMachineInstanceSelector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      workload-type: db       # Matches a key and a value</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="references">References<a class="hash-link" href="#references" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="documents">Documents<a class="hash-link" href="#documents" title="Direct link to heading">​</a></h3><h3 class="anchor anchorWithStickyNavbar_mojV" id="libvirt-guest-migration">Libvirt Guest Migration<a class="hash-link" href="#libvirt-guest-migration" title="Direct link to heading">​</a></h3><p><code>Libvirt</code> has a chapter to describe the pricipal of <code>VM/Guest Live Migration</code>.</p><p><a href="https://libvirt.org/migration.html" target="_blank" rel="noopener noreferrer">https://libvirt.org/migration.html</a></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="kubevirt-live-migration">Kubevirt Live Migration<a class="hash-link" href="#kubevirt-live-migration" title="Direct link to heading">​</a></h3><p><a href="https://kubevirt.io/user-guide/operations/live_migration/" target="_blank" rel="noopener noreferrer">https://kubevirt.io/user-guide/operations/live_migration/</a></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="source-code">Source Code<a class="hash-link" href="#source-code" title="Direct link to heading">​</a></h3><p>The <code>VM Live Migration</code> related configuration options are passed to each layer correspondingly.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="kubevirt">Kubevirt<a class="hash-link" href="#kubevirt" title="Direct link to heading">​</a></h4><p><a href="https://github.com/kubevirt/kubevirt/blob/d425593ae392111dab80403ef0cde82625e37653/pkg/virt-launcher/virtwrap/live-migration-source.go#L103" target="_blank" rel="noopener noreferrer">https://github.com/kubevirt/kubevirt/blob/d425593ae392111dab80403ef0cde82625e37653/pkg/virt-launcher/virtwrap/live-migration-source.go#L103</a></p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;libvirt.org/go/libvirt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">func generateMigrationFlags(isBlockMigration, migratePaused bool, options *cmdclient.MigrationOptions) libvirt.DomainMigrateFlags {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if options.AllowAutoConverge {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        migrateFlags |= libvirt.MIGRATE_AUTO_CONVERGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if options.AllowPostCopy {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        migrateFlags |= libvirt.MIGRATE_POSTCOPY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="go-package-libvirt">Go Package Libvirt<a class="hash-link" href="#go-package-libvirt" title="Direct link to heading">​</a></h4><p><a href="https://pkg.go.dev/libvirt.org/go/libvirt" target="_blank" rel="noopener noreferrer">https://pkg.go.dev/libvirt.org/go/libvirt</a></p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">const (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MIGRATE_AUTO_CONVERGE                 = DomainMigrateFlags(C.VIR_MIGRATE_AUTO_CONVERGE)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MIGRATE_RDMA_PIN_ALL                  = DomainMigrateFlags(C.VIR_MIGRATE_RDMA_PIN_ALL)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MIGRATE_POSTCOPY                      = DomainMigrateFlags(C.VIR_MIGRATE_POSTCOPY)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="libvirt">Libvirt<a class="hash-link" href="#libvirt" title="Direct link to heading">​</a></h4><p><a href="https://github.com/libvirt/libvirt/blob/bfe53e9145cd5996a791c5caff0686572b850f82/include/libvirt/libvirt-domain.h#L1030" target="_blank" rel="noopener noreferrer">https://github.com/libvirt/libvirt/blob/bfe53e9145cd5996a791c5caff0686572b850f82/include/libvirt/libvirt-domain.h#L1030</a></p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    /* Enable algorithms that ensure a live migration will eventually converge.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * This usually means the domain will be slowed down to make sure it does</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * not change its memory faster than a hypervisor can transfer the changed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * memory to the destination host. VIR_MIGRATE_PARAM_AUTO_CONVERGE_*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * parameters can be used to tune the algorithm.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Since: 1.2.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    VIR_MIGRATE_AUTO_CONVERGE = (1 &lt;&lt; 13),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   /* Setting the VIR_MIGRATE_POSTCOPY flag tells libvirt to enable post-copy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * migration. However, the migration will start normally and</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * virDomainMigrateStartPostCopy needs to be called to switch it into the</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * post-copy mode. See virDomainMigrateStartPostCopy for more details.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Since: 1.3.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    VIR_MIGRATE_POSTCOPY = (1 &lt;&lt; 15),</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/kb/tags/harvester">harvester</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/kb/tags/virtual-machine">virtual machine</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/kb/tags/vm">VM</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/kb/tags/live-migration">live migration</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/kb/tags/policy">policy</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/kb/tags/strategy">strategy</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/kb/tags/configuration">configuration</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about VM Live Migration Policy and Configuration" href="/kb/vm_live_migration_policy_and_configuration"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/kb/multiple-nics-vm-connectivity">Multiple NICs VM Connectivity</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2022-03-10T00:00:00.000Z" itemprop="datePublished">March 10, 2022</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/tjjh89017" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://github.com/tjjh89017.png" alt="Date Huang"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/tjjh89017" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Date Huang</span></a></div><small class="avatar__subtitle" itemprop="description">Software Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_mojV" id="what-is-the-default-behavior-of-a-vm-with-multiple-nics">What is the default behavior of a VM with multiple NICs<a class="hash-link" href="#what-is-the-default-behavior-of-a-vm-with-multiple-nics" title="Direct link to heading">​</a></h2><p>In <a href="https://github.com/harvester/harvester/issues/1059" target="_blank" rel="noopener noreferrer">some scenarios</a>, you&#x27;ll setup two or more NICs in your VM to serve different networking purposes. If all networks are setup by default with DHCP, you might get random connectivity issues. And while it might get fixed after rebooting the VM, it still will lose connection randomly after some period.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="how-to-identify-connectivity-issues">How-to identify connectivity issues<a class="hash-link" href="#how-to-identify-connectivity-issues" title="Direct link to heading">​</a></h2><p>In a Linux VM, you can use commands from the <code>iproute2</code> package to identify the default route.</p><p>In your VM, execute the following command:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ip</span><span class="token plain"> route show default</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>If you get the <code>access denied</code> error, please run the command using <code>sudo</code></p></div></div><p>The output of this command will only show the default route with the gateway and VM IP of the primary network interface (<code>eth0</code> in the example below).</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">default via &lt;Gateway IP&gt; dev eth0 proto dhcp src &lt;VM IP&gt; metric 100</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Here is the full example:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ ip route show default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default via 192.168.0.254 dev eth0 proto dhcp src 192.168.0.100 metric 100</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>However, if the issue covered in this KB occurs, you&#x27;ll only be able to connect to the VM via the VNC or serial console.</p><p>Once connected, you can run again the same command as before:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ip</span><span class="token plain"> route show default</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>However, this time you&#x27;ll get a default route with an incorrect gateway IP.
For example:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">default via &lt;Incorrect Gateway IP&gt; dev eth0 proto dhcp src &lt;VM&#x27;s IP&gt; metric 100</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="why-do-connectivity-issues-occur-randomly">Why do connectivity issues occur randomly<a class="hash-link" href="#why-do-connectivity-issues-occur-randomly" title="Direct link to heading">​</a></h2><p>In a standard setup, cloud-based VMs typically use DHCP for their NICs configuration. It will set an IP and a gateway for each NIC. Lastly, a default route to the gateway IP will also be added, so you can use its IP to connect to the VM.</p><p>However, Linux distributions start multiple DHCP clients at the same time and do not have a <strong>priority</strong> system. This means that if you have two or more NICs configured with DHCP, the client will enter a <strong>race condition</strong> to configure the default route. And depending on the currently running Linux distribution DHCP script, there is no guarantee which default route will be configured.</p><p>As the default route might change in every DHCP renewing process or after every OS reboot, this will create network connectivity issues.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="how-to-avoid-the-random-connectivity-issues">How to avoid the random connectivity issues<a class="hash-link" href="#how-to-avoid-the-random-connectivity-issues" title="Direct link to heading">​</a></h2><p>You can easily avoid these connectivity issues by having only one NIC attached to the VM and having only one IP and one gateway configured.</p><p>However, for VMs in more complex infrastructures, it is often not possible to use just one NIC. For example, if your infrastructure has a storage network and a service network. For security reasons, the storage network will be isolated from the service network and have a separate subnet. In this case, you must have two NICs to connect to both the service and storage networks.</p><p>You can choose a solution below that meets your requirements and security policy.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="disable-dhcp-on-secondary-nic">Disable DHCP on secondary NIC<a class="hash-link" href="#disable-dhcp-on-secondary-nic" title="Direct link to heading">​</a></h3><p>As mentioned above, the problem is caused by a <code>race condition</code> between two DHCP clients. One solution to avoid this problem is to disable DHCP for all NICs and configure them with static IPs only. Likewise, you can configure the secondary NIC with a static IP and keep the primary NIC enabled with DHCP.</p><ol><li>To configure the primary NIC with a static IP (<code>eth0</code> in this example), you can edit the file <code>/etc/sysconfig/network/ifcfg-eth0</code> with the following values:</li></ol><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">BOOTPROTO=&#x27;static&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPADDR=&#x27;192.168.0.100&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NETMASK=&#x27;255.255.255.0&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Alternatively, if you want to reserve the primary NIC using DHCP (<code>eth0</code> in this example), use the following values instead:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">BOOTPROTO=&#x27;dhcp&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DHCLIENT_SET_DEFAULT_ROUTE=&#x27;yes&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ol start="2"><li>You need to configure the default route by editing the file <code>/etc/sysconfig/network/ifroute-eth0</code> (if you configured the primary NIC using DHCP, skip this step):</li></ol><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain"># Destination  Dummy/Gateway  Netmask  Interface</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default        192.168.0.254  -        eth0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>Do not put other default route for your secondary NIC</p></div></div><ol start="3"><li>Finally, configure a static IP for the secondary NIC by editing the file <code>/etc/sysconfig/network/ifcfg-eth1</code>:</li></ol><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">BOOTPROTO=&#x27;static&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPADDR=&#x27;10.0.0.100&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NETMASK=&#x27;255.255.255.0&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="cloud-init-config">Cloud-Init config<a class="hash-link" href="#cloud-init-config" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">network</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> physical</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eth0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">subnets</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dhcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> physical</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eth1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">subnets</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> static</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">address</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 10.0.0.100/24</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="disable-secondary-nic-default-route-from-dhcp">Disable secondary NIC default route from DHCP<a class="hash-link" href="#disable-secondary-nic-default-route-from-dhcp" title="Direct link to heading">​</a></h3><p>If your secondary NIC requires to get its IP from DHCP, you&#x27;ll need to disable the secondary NIC default route configuration.</p><ol><li>Confirm that the primary NIC configures its default route in the file <code>/etc/sysconfig/network/ifcfg-eth0</code>:</li></ol><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">BOOTPROTO=&#x27;dhcp&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DHCLIENT_SET_DEFAULT_ROUTE=&#x27;yes&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ol start="2"><li>Disable the secondary NIC default route configuration by editing the file <code>/etc/sysconfig/network/ifcfg-eth1</code>:</li></ol><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">BOOTPROTO=&#x27;dhcp&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DHCLIENT_SET_DEFAULT_ROUTE=&#x27;no&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="cloud-init-config-1">Cloud-Init config<a class="hash-link" href="#cloud-init-config-1" title="Direct link to heading">​</a></h4><p>This solution is not available in Cloud-Init. Cloud-Init didn&#x27;t allow any option for DHCP.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/kb/tags/vm">vm</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/kb/tags/network">network</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Multiple NICs VM Connectivity" href="/kb/multiple-nics-vm-connectivity"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/kb/vm-scheduling">VM Scheduling</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2022-03-07T00:00:00.000Z" itemprop="datePublished">March 7, 2022</time> · <!-- -->16 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/FrankYang0529" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://github.com/FrankYang0529.png" alt="PoAn Yang"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/FrankYang0529" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">PoAn Yang</span></a></div><small class="avatar__subtitle" itemprop="description">Software Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_mojV" id="how-does-harvester-schedule-a-vm">How does Harvester schedule a VM?<a class="hash-link" href="#how-does-harvester-schedule-a-vm" title="Direct link to heading">​</a></h2><p>Harvester doesn&#x27;t directly schedule a VM in Kubernetes, it relies on <a href="http://kubevirt.io/" target="_blank" rel="noopener noreferrer">KubeVirt</a> to create the custom resource <code>VirtualMachine</code>. When the request to create a new VM is sent, a <code>VirtualMachineInstance</code> object is created and it creates the corresponding <code>Pod</code>.</p><p>The whole VM creation processt leverages <code>kube-scheduler</code>, which allows Harvester to use <code>nodeSelector</code>, <code>affinity</code>, and resources request/limitation to influence where a VM will be deployed.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="how-does-kube-scheduler-decide-where-to-deploy-a-vm">How does kube-scheduler decide where to deploy a VM?<a class="hash-link" href="#how-does-kube-scheduler-decide-where-to-deploy-a-vm" title="Direct link to heading">​</a></h2><p>First, <code>kube-scheduler</code> finds Nodes available to run a pod. After that, <code>kube-scheduler</code> scores each available Node by a list of <a href="https://github.com/kubernetes/kubernetes/tree/v1.22.7/pkg/scheduler/framework/plugins" target="_blank" rel="noopener noreferrer">plugins</a> like <a href="https://github.com/kubernetes/kubernetes/blob/v1.22.7/pkg/scheduler/framework/plugins/imagelocality/image_locality.go" target="_blank" rel="noopener noreferrer">ImageLocality</a>, <a href="https://github.com/kubernetes/kubernetes/tree/v1.22.7/pkg/scheduler/framework/plugins/interpodaffinity" target="_blank" rel="noopener noreferrer">InterPodAffinity</a>, <a href="https://github.com/kubernetes/kubernetes/tree/v1.22.7/pkg/scheduler/framework/plugins/nodeaffinity" target="_blank" rel="noopener noreferrer">NodeAffinity</a>, etc. </p><p>Finally, <code>kube-scheduler</code> calculates the scores from the plugins results for each Node, and select the Node with the highest score to deploy the Pod.</p><p>For example, let&#x27;s say  we have a three nodes Harvester cluster with 6 cores CPU and 16G RAM each, and we want to deploy a VM with 1 CPU and 1G RAM (without resources overcommit). </p><p><code>kube-scheduler</code> will summarize the scores, as displayed in  <em>Table 1</em> below, and will select the node with the highest score, <code>harvester-node-2</code> in this case, to deploy the VM.</p><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>kube-scheduler logs</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm-without-overcommit-75q9b -&gt; harvester-node-0: NodeResourcesBalancedAllocation, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:9960 memory:15166603264] ,score 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm-without-overcommit-75q9b -&gt; harvester-node-1: NodeResourcesBalancedAllocation, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:5560 memory:6352273408] ,score 45,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm-without-overcommit-75q9b -&gt; harvester-node-2: NodeResourcesBalancedAllocation, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:5350 memory:5941231616] ,score 46,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm-without-overcommit-75q9b -&gt; harvester-node-0: NodeResourcesLeastAllocated, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:9960 memory:15166603264] ,score 4,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm-without-overcommit-75q9b -&gt; harvester-node-1: NodeResourcesLeastAllocated, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:5560 memory:6352273408] ,score 34,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm-without-overcommit-75q9b -&gt; harvester-node-2: NodeResourcesLeastAllocated, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:5350 memory:5941231616] ,score 37,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;ImageLocality&quot; node=&quot;harvester-node-0&quot; score=54</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;ImageLocality&quot; node=&quot;harvester-node-1&quot; score=54</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;ImageLocality&quot; node=&quot;harvester-node-2&quot; score=54</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;InterPodAffinity&quot; node=&quot;harvester-node-0&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;InterPodAffinity&quot; node=&quot;harvester-node-1&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;InterPodAffinity&quot; node=&quot;harvester-node-2&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;NodeResourcesLeastAllocated&quot; node=&quot;harvester-node-0&quot; score=4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;NodeResourcesLeastAllocated&quot; node=&quot;harvester-node-1&quot; score=34</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;NodeResourcesLeastAllocated&quot; node=&quot;harvester-node-2&quot; score=37</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;NodeAffinity&quot; node=&quot;harvester-node-0&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;NodeAffinity&quot; node=&quot;harvester-node-1&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;NodeAffinity&quot; node=&quot;harvester-node-2&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;NodePreferAvoidPods&quot; node=&quot;harvester-node-0&quot; score=1000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;NodePreferAvoidPods&quot; node=&quot;harvester-node-2&quot; score=1000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;NodePreferAvoidPods&quot; node=&quot;harvester-node-1&quot; score=1000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;PodTopologySpread&quot; node=&quot;harvester-node-0&quot; score=200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;PodTopologySpread&quot; node=&quot;harvester-node-1&quot; score=200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;PodTopologySpread&quot; node=&quot;harvester-node-2&quot; score=200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;TaintToleration&quot; node=&quot;harvester-node-0&quot; score=100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;TaintToleration&quot; node=&quot;harvester-node-1&quot; score=100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;TaintToleration&quot; node=&quot;harvester-node-2&quot; score=100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;NodeResourcesBalancedAllocation&quot; node=&quot;harvester-node-0&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;NodeResourcesBalancedAllocation&quot; node=&quot;harvester-node-1&quot; score=45</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; plugin=&quot;NodeResourcesBalancedAllocation&quot; node=&quot;harvester-node-2&quot; score=46</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Calculated node&#x27;s final score for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; node=&quot;harvester-node-0&quot; score=1000358</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Calculated node&#x27;s final score for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; node=&quot;harvester-node-1&quot; score=1000433</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Calculated node&#x27;s final score for pod&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; node=&quot;harvester-node-2&quot; score=1000437</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AssumePodVolumes for pod &quot;default/virt-launcher-vm-without-overcommit-75q9b&quot;, node &quot;harvester-node-2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AssumePodVolumes for pod &quot;default/virt-launcher-vm-without-overcommit-75q9b&quot;, node &quot;harvester-node-2&quot;: all PVCs bound and nothing to do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Attempting to bind pod to node&quot; pod=&quot;default/virt-launcher-vm-without-overcommit-75q9b&quot; node=&quot;harvester-node-2&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><p><strong>Table 1 - kube-scheduler scores example</strong></p><table><thead><tr><th align="center"></th><th align="center">harvester-node-0</th><th align="center">harvester-node-1</th><th align="center">harvester-node-2</th></tr></thead><tbody><tr><td align="center">ImageLocality</td><td align="center">54</td><td align="center">54</td><td align="center">54</td></tr><tr><td align="center">InterPodAffinity</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">NodeResourcesLeastAllocated</td><td align="center">4</td><td align="center">34</td><td align="center">37</td></tr><tr><td align="center">NodeAffinity</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">NodePreferAvoidPods</td><td align="center">1000000</td><td align="center">1000000</td><td align="center">1000000</td></tr><tr><td align="center">PodTopologySpread</td><td align="center">200</td><td align="center">200</td><td align="center">200</td></tr><tr><td align="center">TaintToleration</td><td align="center">100</td><td align="center">100</td><td align="center">100</td></tr><tr><td align="center">NodeResourcesBalancedAllocation</td><td align="center">0</td><td align="center">45</td><td align="center">46</td></tr><tr><td align="center">Total</td><td align="center">1000358</td><td align="center">1000433</td><td align="center">1000437</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_mojV" id="why-vms-are-distributed-unevenly-with-overcommit">Why VMs are distributed unevenly with overcommit?<a class="hash-link" href="#why-vms-are-distributed-unevenly-with-overcommit" title="Direct link to heading">​</a></h2><p>With resources overcommit, Harvester modifies the resources request. By default, the <code>overcommit</code> configuration is <code>{&quot;cpu&quot;: 1600, &quot;memory&quot;: 150, &quot;storage&quot;:  200}</code>. This means that if we request a VM with 1 CPU and 1G RAM, its <code>resources.requests.cpu</code> will become <code>62m</code>. </p><p>!!! note
The unit suffix <code>m</code> stands for &quot;thousandth of a core.&quot;</p><p>To explain it, let&#x27;s take the case of CPU overcommit. The default value of 1 CPU is equal to 1000m CPU, and with the default overcommit configuration of <code>&quot;cpu&quot;: 1600</code>, the CPU resource will be 16x smaller. Here is the calculation: <code>1000m * 100 / 1600 = 62m</code>.</p><p>Now, we can see how overcommitting influences <code>kube-scheduler</code> scores.</p><p>In this example, we use a three nodes Harvester cluster with 6 cores and 16G RAM each. We will deploy two VMs with 1 CPU and 1G RAM, and we will compare the scores for both cases of &quot;with-overcommit&quot; and &quot;without-overcommit&quot; resources. </p><p>The results of both tables <em>Table 2</em> and <em>Table 3</em> can be explained as follow:</p><p>In the &quot;with-overcommit&quot; case, both VMs are deployed on <code>harvester-node-2</code>, however in the &quot;without-overcommit&quot; case, the VM1 is deployed on <code>harvester-node-2</code>, and VM2 is deployed on <code>harvester-node-1</code>. </p><p>If we look at the detailed scores, we&#x27;ll see a variation of <code>Total Score</code> for <code>harvester-node-2</code> from <code>1000459</code> to <code>1000461</code> in the &quot;with-overcommit&quot; case, and <code>1000437</code> to <code>1000382</code> in the &quot;without-overcommit case&quot;. It&#x27;s because resources overcommit influences <code>request-cpu</code> and <code>request-memory</code>. </p><p>In the &quot;with-overcommit&quot; case, the <code>request-cpu</code> changes from <code>4412m</code> to <code>4474m</code>. The difference between the two numbers is <code>62m</code>, which is what we calculated above. However, in the &quot;without-overcommit&quot; case, we send <strong>real</strong> requests to <code>kube-scheduler</code>, so the <code>request-cpu</code> changes from <code>5350m</code> to <code>6350m</code>.</p><p>Finally, since most plugins give the same scores for each node except <code>NodeResourcesBalancedAllocation</code> and <code>NodeResourcesLeastAllocated</code>, we&#x27;ll see a difference of these two scores for each node.</p><p>From the results, we can see the overcommit feature influences the final score of each Node, so VMs are distributed unevenly. Although the <code>harvester-node-2</code> score for VM 2 is higher than VM 1, it&#x27;s not always increasing. In <em>Table 4</em>, we keep deploying VM with 1 CPU and 1G RAM, and we can see the score of <code>harvester-node-2</code> starts decreasing from 11th VM. The behavior of <code>kube-scheduler</code> depends on your cluster resources and the workload you deployed.</p><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>kube-scheduler logs for vm1-with-overcommit</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm1-with-overcommit-ljlmq -&gt; harvester-node-0: NodeResourcesBalancedAllocation, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:9022 memory:14807289856] ,score 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm1-with-overcommit-ljlmq -&gt; harvester-node-1: NodeResourcesBalancedAllocation, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:4622 memory:5992960000] ,score 58,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm1-with-overcommit-ljlmq -&gt; harvester-node-2: NodeResourcesBalancedAllocation, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:4412 memory:5581918208] ,score 59,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm1-with-overcommit-ljlmq -&gt; harvester-node-0: NodeResourcesLeastAllocated, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:9022 memory:14807289856] ,score 5,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm1-with-overcommit-ljlmq -&gt; harvester-node-1: NodeResourcesLeastAllocated, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:4622 memory:5992960000] ,score 43,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm1-with-overcommit-ljlmq -&gt; harvester-node-2: NodeResourcesLeastAllocated, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:4412 memory:5581918208] ,score 46,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;InterPodAffinity&quot; node=&quot;harvester-node-0&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;InterPodAffinity&quot; node=&quot;harvester-node-1&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;InterPodAffinity&quot; node=&quot;harvester-node-2&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;NodeResourcesLeastAllocated&quot; node=&quot;harvester-node-0&quot; score=5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;NodeResourcesLeastAllocated&quot; node=&quot;harvester-node-1&quot; score=43</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;NodeResourcesLeastAllocated&quot; node=&quot;harvester-node-2&quot; score=46</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;NodeAffinity&quot; node=&quot;harvester-node-0&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;NodeAffinity&quot; node=&quot;harvester-node-1&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;NodeAffinity&quot; node=&quot;harvester-node-2&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;NodePreferAvoidPods&quot; node=&quot;harvester-node-0&quot; score=1000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;NodePreferAvoidPods&quot; node=&quot;harvester-node-1&quot; score=1000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;NodePreferAvoidPods&quot; node=&quot;harvester-node-2&quot; score=1000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;PodTopologySpread&quot; node=&quot;harvester-node-0&quot; score=200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;PodTopologySpread&quot; node=&quot;harvester-node-1&quot; score=200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;PodTopologySpread&quot; node=&quot;harvester-node-2&quot; score=200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;TaintToleration&quot; node=&quot;harvester-node-0&quot; score=100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;TaintToleration&quot; node=&quot;harvester-node-1&quot; score=100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;TaintToleration&quot; node=&quot;harvester-node-2&quot; score=100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;NodeResourcesBalancedAllocation&quot; node=&quot;harvester-node-0&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;NodeResourcesBalancedAllocation&quot; node=&quot;harvester-node-1&quot; score=58</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;NodeResourcesBalancedAllocation&quot; node=&quot;harvester-node-2&quot; score=59</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;ImageLocality&quot; node=&quot;harvester-node-0&quot; score=54</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;ImageLocality&quot; node=&quot;harvester-node-1&quot; score=54</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; plugin=&quot;ImageLocality&quot; node=&quot;harvester-node-2&quot; score=54</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Calculated node&#x27;s final score for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; node=&quot;harvester-node-0&quot; score=1000359</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Calculated node&#x27;s final score for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; node=&quot;harvester-node-1&quot; score=1000455</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Calculated node&#x27;s final score for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; node=&quot;harvester-node-2&quot; score=1000459</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AssumePodVolumes for pod &quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot;, node &quot;harvester-node-2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AssumePodVolumes for pod &quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot;, node &quot;harvester-node-2&quot;: all PVCs bound and nothing to do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Attempting to bind pod to node&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-ljlmq&quot; node=&quot;harvester-node-2&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>kube-scheduler logs for vm2-with-overcommit</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm2-with-overcommit-pwrx4 -&gt; harvester-node-0: NodeResourcesBalancedAllocation, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:9022 memory:14807289856] ,score 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm2-with-overcommit-pwrx4 -&gt; harvester-node-1: NodeResourcesBalancedAllocation, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:4622 memory:5992960000] ,score 58,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm2-with-overcommit-pwrx4 -&gt; harvester-node-2: NodeResourcesBalancedAllocation, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:4474 memory:6476701696] ,score 64,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm2-with-overcommit-pwrx4 -&gt; harvester-node-0: NodeResourcesLeastAllocated, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:9022 memory:14807289856] ,score 5,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm2-with-overcommit-pwrx4 -&gt; harvester-node-1: NodeResourcesLeastAllocated, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:4622 memory:5992960000] ,score 43,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm2-with-overcommit-pwrx4 -&gt; harvester-node-2: NodeResourcesLeastAllocated, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:4474 memory:6476701696] ,score 43,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;NodeAffinity&quot; node=&quot;harvester-node-0&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;NodeAffinity&quot; node=&quot;harvester-node-1&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;NodeAffinity&quot; node=&quot;harvester-node-2&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;NodePreferAvoidPods&quot; node=&quot;harvester-node-0&quot; score=1000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;NodePreferAvoidPods&quot; node=&quot;harvester-node-1&quot; score=1000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;NodePreferAvoidPods&quot; node=&quot;harvester-node-2&quot; score=1000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;PodTopologySpread&quot; node=&quot;harvester-node-0&quot; score=200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;PodTopologySpread&quot; node=&quot;harvester-node-1&quot; score=200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;PodTopologySpread&quot; node=&quot;harvester-node-2&quot; score=200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;TaintToleration&quot; node=&quot;harvester-node-0&quot; score=100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;TaintToleration&quot; node=&quot;harvester-node-1&quot; score=100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;TaintToleration&quot; node=&quot;harvester-node-2&quot; score=100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;NodeResourcesBalancedAllocation&quot; node=&quot;harvester-node-0&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;NodeResourcesBalancedAllocation&quot; node=&quot;harvester-node-1&quot; score=58</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;NodeResourcesBalancedAllocation&quot; node=&quot;harvester-node-2&quot; score=64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;ImageLocality&quot; node=&quot;harvester-node-0&quot; score=54</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;ImageLocality&quot; node=&quot;harvester-node-1&quot; score=54</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;ImageLocality&quot; node=&quot;harvester-node-2&quot; score=54</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;InterPodAffinity&quot; node=&quot;harvester-node-0&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;InterPodAffinity&quot; node=&quot;harvester-node-1&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;InterPodAffinity&quot; node=&quot;harvester-node-2&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;NodeResourcesLeastAllocated&quot; node=&quot;harvester-node-0&quot; score=5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;NodeResourcesLeastAllocated&quot; node=&quot;harvester-node-1&quot; score=43</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; plugin=&quot;NodeResourcesLeastAllocated&quot; node=&quot;harvester-node-2&quot; score=43</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Calculated node&#x27;s final score for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; node=&quot;harvester-node-0&quot; score=1000359</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Calculated node&#x27;s final score for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; node=&quot;harvester-node-1&quot; score=1000455</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Calculated node&#x27;s final score for pod&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; node=&quot;harvester-node-2&quot; score=1000461</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AssumePodVolumes for pod &quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot;, node &quot;harvester-node-2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AssumePodVolumes for pod &quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot;, node &quot;harvester-node-2&quot;: all PVCs bound and nothing to do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Attempting to bind pod to node&quot; pod=&quot;default/virt-launcher-vm2-with-overcommit-pwrx4&quot; node=&quot;harvester-node-2&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>kube-scheduler logs for vm1-without-overcommit</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm1-with-overcommit-6xqmq -&gt; harvester-node-0: NodeResourcesBalancedAllocation, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:9960 memory:15166603264] ,score 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm1-with-overcommit-6xqmq -&gt; harvester-node-1: NodeResourcesBalancedAllocation, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:5560 memory:6352273408] ,score 45,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm1-with-overcommit-6xqmq -&gt; harvester-node-2: NodeResourcesBalancedAllocation, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:5350 memory:5941231616] ,score 46,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm1-with-overcommit-6xqmq -&gt; harvester-node-0: NodeResourcesLeastAllocated, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:9960 memory:15166603264] ,score 4,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm1-with-overcommit-6xqmq -&gt; harvester-node-1: NodeResourcesLeastAllocated, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:5560 memory:6352273408] ,score 34,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm1-with-overcommit-6xqmq -&gt; harvester-node-2: NodeResourcesLeastAllocated, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:5350 memory:5941231616] ,score 37,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;InterPodAffinity&quot; node=&quot;harvester-node-0&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;InterPodAffinity&quot; node=&quot;harvester-node-1&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;InterPodAffinity&quot; node=&quot;harvester-node-2&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;NodeResourcesLeastAllocated&quot; node=&quot;harvester-node-0&quot; score=4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;NodeResourcesLeastAllocated&quot; node=&quot;harvester-node-1&quot; score=34</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;NodeResourcesLeastAllocated&quot; node=&quot;harvester-node-2&quot; score=37</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;NodeAffinity&quot; node=&quot;harvester-node-0&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;NodeAffinity&quot; node=&quot;harvester-node-1&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;NodeAffinity&quot; node=&quot;harvester-node-2&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;NodePreferAvoidPods&quot; node=&quot;harvester-node-0&quot; score=1000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;NodePreferAvoidPods&quot; node=&quot;harvester-node-1&quot; score=1000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;NodePreferAvoidPods&quot; node=&quot;harvester-node-2&quot; score=1000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;PodTopologySpread&quot; node=&quot;harvester-node-0&quot; score=200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;PodTopologySpread&quot; node=&quot;harvester-node-1&quot; score=200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;PodTopologySpread&quot; node=&quot;harvester-node-2&quot; score=200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;TaintToleration&quot; node=&quot;harvester-node-0&quot; score=100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;TaintToleration&quot; node=&quot;harvester-node-1&quot; score=100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;TaintToleration&quot; node=&quot;harvester-node-2&quot; score=100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;NodeResourcesBalancedAllocation&quot; node=&quot;harvester-node-0&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;NodeResourcesBalancedAllocation&quot; node=&quot;harvester-node-1&quot; score=45</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;NodeResourcesBalancedAllocation&quot; node=&quot;harvester-node-2&quot; score=46</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;ImageLocality&quot; node=&quot;harvester-node-0&quot; score=54</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;ImageLocality&quot; node=&quot;harvester-node-1&quot; score=54</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; plugin=&quot;ImageLocality&quot; node=&quot;harvester-node-2&quot; score=54</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Calculated node&#x27;s final score for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; node=&quot;harvester-node-0&quot; score=1000358</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Calculated node&#x27;s final score for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; node=&quot;harvester-node-1&quot; score=1000433</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Calculated node&#x27;s final score for pod&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; node=&quot;harvester-node-2&quot; score=1000437</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AssumePodVolumes for pod &quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot;, node &quot;harvester-node-2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AssumePodVolumes for pod &quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot;, node &quot;harvester-node-2&quot;: all PVCs bound and nothing to do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Attempting to bind pod to node&quot; pod=&quot;default/virt-launcher-vm1-with-overcommit-6xqmq&quot; node=&quot;harvester-node-2&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>kube-scheduler logs for vm2-without-overcommit</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm2-without-overcommit-mf5vk -&gt; harvester-node-0: NodeResourcesBalancedAllocation, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:9960 memory:15166603264] ,score 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm2-without-overcommit-mf5vk -&gt; harvester-node-1: NodeResourcesBalancedAllocation, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:5560 memory:6352273408] ,score 45,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm2-without-overcommit-mf5vk -&gt; harvester-node-2: NodeResourcesBalancedAllocation, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:6350 memory:7195328512] ,score 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm2-without-overcommit-mf5vk -&gt; harvester-node-0: NodeResourcesLeastAllocated, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:9960 memory:15166603264] ,score 4,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm2-without-overcommit-mf5vk -&gt; harvester-node-1: NodeResourcesLeastAllocated, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:5560 memory:6352273408] ,score 34,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virt-launcher-vm2-without-overcommit-mf5vk -&gt; harvester-node-2: NodeResourcesLeastAllocated, map of allocatable resources map[cpu:6000 memory:16776437760], map of requested resources map[cpu:6350 memory:7195328512] ,score 28,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;PodTopologySpread&quot; node=&quot;harvester-node-0&quot; score=200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;PodTopologySpread&quot; node=&quot;harvester-node-1&quot; score=200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;PodTopologySpread&quot; node=&quot;harvester-node-2&quot; score=200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;TaintToleration&quot; node=&quot;harvester-node-0&quot; score=100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;TaintToleration&quot; node=&quot;harvester-node-1&quot; score=100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;TaintToleration&quot; node=&quot;harvester-node-2&quot; score=100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;NodeResourcesBalancedAllocation&quot; node=&quot;harvester-node-0&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;NodeResourcesBalancedAllocation&quot; node=&quot;harvester-node-1&quot; score=45</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;NodeResourcesBalancedAllocation&quot; node=&quot;harvester-node-2&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;ImageLocality&quot; node=&quot;harvester-node-0&quot; score=54</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;ImageLocality&quot; node=&quot;harvester-node-1&quot; score=54</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;ImageLocality&quot; node=&quot;harvester-node-2&quot; score=54</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;InterPodAffinity&quot; node=&quot;harvester-node-0&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;InterPodAffinity&quot; node=&quot;harvester-node-1&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;InterPodAffinity&quot; node=&quot;harvester-node-2&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;NodeResourcesLeastAllocated&quot; node=&quot;harvester-node-0&quot; score=4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;NodeResourcesLeastAllocated&quot; node=&quot;harvester-node-1&quot; score=34</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;NodeResourcesLeastAllocated&quot; node=&quot;harvester-node-2&quot; score=28</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;NodeAffinity&quot; node=&quot;harvester-node-0&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;NodeAffinity&quot; node=&quot;harvester-node-1&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;NodeAffinity&quot; node=&quot;harvester-node-2&quot; score=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;NodePreferAvoidPods&quot; node=&quot;harvester-node-0&quot; score=1000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;NodePreferAvoidPods&quot; node=&quot;harvester-node-1&quot; score=1000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Plugin scored node for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; plugin=&quot;NodePreferAvoidPods&quot; node=&quot;harvester-node-2&quot; score=1000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Calculated node&#x27;s final score for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; node=&quot;harvester-node-0&quot; score=1000358</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Calculated node&#x27;s final score for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; node=&quot;harvester-node-1&quot; score=1000433</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Calculated node&#x27;s final score for pod&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; node=&quot;harvester-node-2&quot; score=1000382</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AssumePodVolumes for pod &quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot;, node &quot;harvester-node-1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AssumePodVolumes for pod &quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot;, node &quot;harvester-node-1&quot;: all PVCs bound and nothing to do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Attempting to bind pod to node&quot; pod=&quot;default/virt-launcher-vm2-without-overcommit-mf5vk&quot; node=&quot;harvester-node-1&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><p><strong>Table 2 - With Overcommit</strong></p><table><thead><tr><th align="center">VM 1 / VM 2</th><th align="right">harvester-node-0</th><th align="right">harvester-node-1</th><th align="right">harvester-node-2</th></tr></thead><tbody><tr><td align="center">request-cpu (m)</td><td align="right">9022 / 9022</td><td align="right">4622 / 4622</td><td align="right"><strong>4412</strong> / <strong>4474</strong></td></tr><tr><td align="center">request-memory</td><td align="right">14807289856 / 14807289856</td><td align="right">5992960000 / 5992960000</td><td align="right"><strong>5581918208</strong> / <strong>6476701696</strong></td></tr><tr><td align="center">NodeResourcesBalancedAllocation Score</td><td align="right">0 / 0</td><td align="right">58 / 58</td><td align="right"><strong>59</strong> / <strong>64</strong></td></tr><tr><td align="center">NodeResourcesLeastAllocated Score</td><td align="right">5 / 5</td><td align="right">43 / 43</td><td align="right"><strong>46</strong> / <strong>43</strong></td></tr><tr><td align="center">Other Scores</td><td align="right">1000354 / 1000354</td><td align="right">1000354 / 1000354</td><td align="right">1000354 / 1000354</td></tr><tr><td align="center">Total Score</td><td align="right">1000359 / 1000359</td><td align="right">1000455 / 1000455</td><td align="right"><strong>1000459</strong> / <strong>1000461</strong></td></tr></tbody></table><p><strong>Table 3 - Without Overcommit</strong></p><table><thead><tr><th align="center">VM 1 / VM 2</th><th align="right">harvester-node-0</th><th align="right">harvester-node-1</th><th align="right">harvester-node-2</th></tr></thead><tbody><tr><td align="center">request-cpu (m)</td><td align="right">9960 / 9960</td><td align="right">5560 / <strong>5560</strong></td><td align="right"><strong>5350</strong> / 6350</td></tr><tr><td align="center">request-memory</td><td align="right">15166603264 / 15166603264</td><td align="right">6352273408 / <strong>6352273408</strong></td><td align="right"><strong>5941231616</strong> / 7195328512</td></tr><tr><td align="center">NodeResourcesBalancedAllocation Score</td><td align="right">0 / 0</td><td align="right">45 / <strong>45</strong></td><td align="right"><strong>46</strong> / 0</td></tr><tr><td align="center">NodeResourcesLeastAllocated Score</td><td align="right">4 / 4</td><td align="right">34 / <strong>34</strong></td><td align="right"><strong>37</strong> / 28</td></tr><tr><td align="center">Other Scores</td><td align="right">1000354 / 1000354</td><td align="right">1000354 / <strong>1000354</strong></td><td align="right"><strong>1000354</strong> / 1000354</td></tr><tr><td align="center">Total Score</td><td align="right">1000358 / 1000358</td><td align="right">1000358 / <strong>1000433</strong></td><td align="right"><strong>1000437</strong> / 1000382</td></tr></tbody></table><p><strong>Table 4</strong></p><table><thead><tr><th align="center">Score</th><th align="right">harvester-node-0</th><th align="right">harvester-node-1</th><th align="right">harvester-node-2</th></tr></thead><tbody><tr><td align="center">VM 1</td><td align="right">1000359</td><td align="right">1000455</td><td align="right">1000459</td></tr><tr><td align="center">VM 2</td><td align="right">1000359</td><td align="right">1000455</td><td align="right">1000461</td></tr><tr><td align="center">VM 3</td><td align="right">1000359</td><td align="right">1000455</td><td align="right">1000462</td></tr><tr><td align="center">VM 4</td><td align="right">1000359</td><td align="right">1000455</td><td align="right">1000462</td></tr><tr><td align="center">VM 5</td><td align="right">1000359</td><td align="right">1000455</td><td align="right">1000463</td></tr><tr><td align="center">VM 6</td><td align="right">1000359</td><td align="right">1000455</td><td align="right">1000465</td></tr><tr><td align="center">VM 7</td><td align="right">1000359</td><td align="right">1000455</td><td align="right">1000466</td></tr><tr><td align="center">VM 8</td><td align="right">1000359</td><td align="right">1000455</td><td align="right">1000467</td></tr><tr><td align="center">VM 9</td><td align="right">1000359</td><td align="right">1000455</td><td align="right">1000469</td></tr><tr><td align="center">VM 10</td><td align="right">1000359</td><td align="right">1000455</td><td align="right">1000469</td></tr><tr><td align="center">VM 11</td><td align="right">1000359</td><td align="right">1000455</td><td align="right"><strong>1000465</strong></td></tr><tr><td align="center">VM 12</td><td align="right">1000359</td><td align="right">1000455</td><td align="right"><strong>1000457</strong></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_mojV" id="how-to-avoid-uneven-distribution-of-vms">How to avoid uneven distribution of VMs?<a class="hash-link" href="#how-to-avoid-uneven-distribution-of-vms" title="Direct link to heading">​</a></h2><p>There are many plugins in <code>kube-scheduler</code> which we can use to influence the scores. For example, we can add the <code>podAntiAffinity</code> plugin to avoid VMs with the same labels being deployed on the same node.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">  affinity:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    podAntiAffinity:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      preferredDuringSchedulingIgnoredDuringExecution:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - podAffinityTerm:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          labelSelector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            matchExpressions:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - key: harvesterhci.io/creator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              operator: Exists</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          topologyKey: kubernetes.io/hostname</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        weight: 100</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="how-to-see-scores-in-kube-scheduler">How to see scores in kube-scheduler?<a class="hash-link" href="#how-to-see-scores-in-kube-scheduler" title="Direct link to heading">​</a></h2><p><code>kube-scheduler</code> is deployed as a static pod in Harvester. The file is under <code>/var/lib/rancher/rke2/agent/pod-manifests/kube-scheduler.yaml</code> in each Management Node. We can add <code>- --v=10</code> to the <code>kube-scheduler</code> container to show score logs.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kind: Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    component: kube-scheduler</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tier: control-plane</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: kube-scheduler</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: kube-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - command:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - kube-scheduler</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - --v=10</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/kb/tags/vm">vm</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/kb/tags/scheduling">scheduling</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about VM Scheduling" href="/kb/vm-scheduling"><b>Read More</b></a></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 harvesterhci.io</div></div></div></footer></div>
<script src="/assets/js/runtime~main.0c08fa38.js"></script>
<script src="/assets/js/main.2aa1bfff.js"></script>
</body>
</html>